{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    {% block header_block %}
        {% include 'head.html' %}
    {% endblock %}
    <link rel="stylesheet" href="{% static '/css/chatRoom.css' %}">
    {{ previous_messages|json_script:'initMsgJSON' }}
    <script type="text/javascript">
        var initialMessages = JSON.parse(document.getElementById('initMsgJSON').text);
        var myEmail = '{{ self_email }}';
    </script>
    <script src="{% static '/js/chatRoom.js' %}" defer='defer'></script>
</head>

<body>
    <form class="form-inline" method="post" action="{% url 'account_logout' %}">
        {% csrf_token %}
        <button class="btn btn-link nav-link" type="submit">Logout</button>
    </form>

    <div class="column channelColumn">
        <h2>Channels</h2>
        <ul>
            {% for i in channelList %}
                <li>{{ i.channelName }}</li>
            {% endfor %}
        </ul>
    </div>

    <div class="column chatColumn">
        <div id="chatWindow" v-bind:style="chatWindowStyleObject">
            <div v-for="msg in messages" id="forMsg">
                <div v-if="msg.email === selfEmail" id="v-ifEmail">
                    <div v-bind:style="[baseStyleObject, selfStyleObject, normalStyleObject]" class="doAfter">
                        <p>[[ msg.firstName ]] [[ msg.lastName ]]</p>
                        <p>[[ msg.contents ]]</p>
                        <p v-bind:style="selfTimeStyleObject">[[ msg.time ]]</p>
                    </div>
                </div>
                <div v-else id="v-elseNotEmail">
                    <div v-if="msg.fromOrg === true" id="v-ifFromOrg">
                        <div v-bind:style="[baseStyleObject, organizerStyleObject]" id="isOrgMsgCont" class="doAfter">
                            <p>[[ msg.firstName ]] [[ msg.lastName ]]</p>
                            <p>[[ msg.contents ]]</p>
                            <p v-bind:style="normalTimeStyleObject">[[ msg.time ]]</p>
                        </div>
                    </div>
                    <div v-else>
                        <div v-bind:style="[baseStyleObject, normalStyleObject]" id="isNormMsgCont" class="doAfter">
                            <h6>[[ msg.firstName ]] [[ msg.lastName ]]</h6>
                            <p>[[ msg.contents ]]</p>
                            <p v-bind:style="normalTimeStyleObject">[[ msg.time ]]</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="chatTypeWindow" v-bind:style="divStyleObject">
            <h3>Typing box here</h3>
        </div>
    </div>

    <div class="column participantColumn">
        <h2>Organizers</h2>
        <ul>
            {% for i in organizerList %}
                <li>{{ i.first_name }} {{ i.last_name }}</li>
            {% endfor %}
        </ul>

        <h2>Participants</h2>
        <ul>
            {% for i in userList %}
                <li>{{ i.first_name }} {{ i.last_name }}</li>
            {% endfor %}
        </ul>
    </div>
</body>

</html>